@inject NavigationManager navigationManager;
@inject AuthenticationStateProvider authenticationStateProvider

@inherits LayoutComponentBase

<MudThemeProvider Theme="@LightTheme.GetTheme()"/>
<MudDialogProvider/>
<MudSnackbarProvider/>

<PageTitle>ASBNApp</PageTitle>

@if(_conditionChecked)
{
    <MudLayout>
        <NavBar />
        <MudMainContent>
            @Body
        </MudMainContent>
    </MudLayout>
}


@code{
    private bool _conditionChecked;

    /// <summary>
    /// Decide what page to show based on if the user is logged in or not.
    /// </summary>
    protected override async void OnInitialized()
    {
        var authState = await authenticationStateProvider.GetAuthenticationStateAsync();
        _conditionChecked = true;

        if(!authState.User.Identity.IsAuthenticated)
        {
            navigationManager.NavigateTo("/");
        }
        else
        {
            navigationManager.NavigateTo("/app");
        }
    }
}