@* Nav Bar item *@

@inject IAccountManagement Acct
@inject NavigationManager navigationManager

@using ASBNApp.Frontend.Services;

<MudAppBar>
    <MudImage Src="images/Logo-Rect-Grey-Dark.png" Width="100" Class="me-10" Alt="ASBN App Logo"/>
    <MudButton Href="/app" Color="Color.Inherit" Class="me-5">Start</MudButton>
    <MudButton Href="export" Color="Color.Inherit">Export</MudButton>
    <MudSpacer />

    <AuthorizeView>
        <Authorized>
            @if (_isLoggingOut)
            {
                <MudProgressCircular Size="Size.Small" Indeterminate="true" Color="Color.Inherit" />
            }
            else
            {
                <MudTooltip Text="Logout">
                    <MudIconButton Icon="@Icons.Material.Filled.Logout" Color="Color.Inherit" OnClick="HandleLogout" />
                </MudTooltip>
            }
        </Authorized>
    </AuthorizeView>

    <MudTooltip Text="Settings">
        <MudIconButton Icon="@Icons.Material.Filled.Settings" Color="Color.Inherit" Href="settings" />
    </MudTooltip>
</MudAppBar>


@code 
{
    private bool _isLoggingOut;

    private async Task HandleLogout()
    {
        _isLoggingOut = true;
        await Acct.LogoutAsync();
        navigationManager.NavigateTo("/");
        _isLoggingOut = false;
    }
}